<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buy Coins</title>
  <style>
    :root{ --tk-red:#FE2C55; --tk-cyan:#25F4EE; --tk-gray:#F2F3F5; --tk-gray-text:#6B6F76; --text:#0f0f0f; }
    *{box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;background:#f5f5f5;margin:0;padding:20px;text-align:center;color:var(--text)}
    .container{max-width:520px;margin:20px auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 20px rgba(0,0,0,.08);position:relative}
    .logo{width:100px;position:absolute;left:10px;top:10px}
    .divider{margin-top:70px;border-bottom:1px solid #ddd;margin-bottom:12px}
    h1{margin:8px 0 16px;font-size:20px}

    /* Coin packages TikTok style */
    .package-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(118px,1fr));gap:14px}
    .package{border:1px solid transparent;border-radius:18px;background:var(--tk-gray);box-shadow:none;padding:14px 16px;cursor:pointer;transition:border-color .18s ease,background .18s ease,transform .08s}
    .package:active{transform:scale(.99)}
    .coin{display:flex;align-items:center;justify-content:center;gap:4px;font-size:20px;font-weight:800;color:var(--text)}
    .coin img{width:40px;height:auto}
    .price{margin-top:6px;font-size:14px;color:var(--tk-gray-text)}
    .package.selected{border-color:var(--tk-red);background:#FFF1F4;box-shadow:inset 0 0 0 2px rgba(254,44,85,.06)}
    @media (max-width:390px){.package{padding:12px;border-radius:16px}.coin{font-size:18px}.price{font-size:13px}.coin img{width:36px}}

    .field{margin-top:16px;text-align:left}
    .field label{display:block;margin-bottom:6px;font-weight:600}
    .field input{width:100%;padding:10px;font-size:14px;border:1px solid #ccc;border-radius:8px}
    .field input[readonly]{background:#fafafa;cursor:pointer}

    /* Payment logos (outside): equal size & aligned left */
    .payment-logos{display:flex;flex-wrap:wrap;gap:12px;justify-content:flex-start;margin:14px 0}
    .payment-logos img{width:72px;height:40px;object-fit:contain;object-position:left center;transition:transform .15s}
    .payment-logos img:active{transform:scale(.95)}

    .btn{margin-top:6px;width:100%;background:var(--tk-red);color:#fff;border:0;border-radius:10px;padding:12px;font-size:16px;font-weight:700;cursor:pointer}

    /* Last purchase bar */
    .last-purchase{display:none;margin-top:10px;font-size:14px;color:#333;background:#f8f8f8;border:1px solid #eee;border-radius:10px;padding:10px;text-align:left}

    /* Payment Modal */
    .pm-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:1100}
    .pm-wrap{background:#fff;border-radius:16px;max-width:520px;margin:60px auto;padding:16px;box-shadow:0 10px 40px rgba(0,0,0,.2);position:relative}
    .pm-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:12px;border-bottom:1px solid #eee}
    .pm-title{font-size:20px;font-weight:700}
    .pm-close{background:transparent;border:0;font-size:22px;cursor:pointer}
    .pm-list{margin:16px 0;display:flex;flex-direction:column;gap:10px}
    .pm-item{display:flex;justify-content:space-between;align-items:center;border:1px solid #ddd;border-radius:12px;padding:12px;cursor:pointer;background:#fff}
    .pm-item.active{border-color:var(--tk-red);box-shadow:0 0 0 2px rgba(254,44,85,.18)}
    .pm-left{display:flex;align-items:center;gap:10px}
    .pm-radio{width:18px;height:18px;border-radius:50%;border:2px solid #bbb;position:relative}
    .pm-item.active .pm-radio{border-color:var(--tk-red)}
    .pm-item.active .pm-radio::after{content:"";position:absolute;inset:3px;border-radius:50%;background:var(--tk-red)}
    .pm-name{font-weight:600}
    .pm-right{display:flex;gap:8px;align-items:center}
    .pm-right img{width:72px;height:22px;object-fit:contain}
    .pm-card{display:none;margin-top:12px;border:1px dashed #ccc;border-radius:10px;padding:12px;background:#fafafa}
    .pm-card .vcard{background:linear-gradient(135deg,var(--tk-red),var(--tk-cyan));color:#fff;border-radius:12px;padding:14px;display:flex;justify-content:center;font-weight:700}
    .pm-footer{display:flex;justify-content:space-between;align-items:center;margin-top:16px}
    .pm-total{font-weight:700}
    .pm-pay{background:var(--tk-red);color:#fff;border:0;border-radius:999px;padding:12px 20px;font-weight:700;cursor:pointer}

    /* Loading modal (spinner centered fullscreen) */
    .loading-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:1200;display:flex;align-items:center;justify-content:center}
    .spinner{width:48px;height:48px;border:5px solid #f3f3f3;border-top:5px solid var(--tk-red);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Success modal: centered rounded square */
    .final-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:1300;display:flex;align-items:center;justify-content:center}
    .final-card{background:#fff;border-radius:20px;padding:20px;width:320px;height:320px;display:flex;flex-direction:column;justify-content:center;align-items:center;position:relative;box-shadow:0 12px 40px rgba(0,0,0,.15);text-align:center}
    .final-close{position:absolute;right:10px;top:8px;background:transparent;border:0;font-size:22px;cursor:pointer}
    .check{width:56px;height:56px;border-radius:16px;background:#2ecc71;position:relative;margin-bottom:8px}
    .check::after{content:"";position:absolute;left:18px;top:13px;width:20px;height:12px;border:4px solid #fff;border-top:none;border-right:none;transform:rotate(-45deg)}
    .final-title{margin:6px 0 4px 0;font-size:18px;font-weight:800}
    .final-details{margin-top:4px;font-size:15px;color:#333}
    .final-details b{font-weight:800}
  </style>
</head>
<body>
  <div class="container">
    <img class="logo" src="https://inuvdp.com/wp-content/uploads/2022/08/tiktok-02.jpg" alt="TikTok"/>
    <div class="divider"></div>
    <h1>Buy Coins</h1>

    <!-- Packages (USD) -->
    <div class="package-list" id="pkgList">
      <div class="package" data-coins="16" data-price="0.25"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>16</span></div><div class="price">US$0.25</div></div>
      <div class="package" data-coins="70" data-price="0.99"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>70</span></div><div class="price">US$0.99</div></div>
      <div class="package" data-coins="350" data-price="4.99"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>350</span></div><div class="price">US$4.99</div></div>
      <div class="package" data-coins="700" data-price="9.99"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>700</span></div><div class="price">US$9.99</div></div>
      <div class="package" data-coins="1400" data-price="19.99"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>1,400</span></div><div class="price">US$19.99</div></div>
      <div class="package" data-coins="3500" data-price="49.99"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>3,500</span></div><div class="price">US$49.99</div></div>
      <div class="package" data-coins="7000" data-price="99.99"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>7,000</span></div><div class="price">US$99.99</div></div>
      <div class="package" data-coins="17500" data-price="249.99"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>17,500</span></div><div class="price">US$249.99</div></div>
    </div>

    <!-- TikTok ID -->
    <div class="field">
      <label for="tiktokId">TikTok ID</label>
      <input type="text" id="tiktokId" placeholder="@username">
    </div>

    <!-- Custom amount (opens keypad) -->
    <div class="field">
      <label for="coinAmountBtn">Coin amount (custom)</label>
      <input id="coinAmountBtn" type="text" placeholder="Tap to enter…" readonly onclick="openQtySheet()">
    </div>

    <!-- Logos row (outside) -->
    <div class="payment-logos">
      <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Visa">
      <img src="https://cdn.haitrieu.com/wp-content/uploads/2022/10/Icon-VNPAY-QR.png" alt="VNPAY QR">
      <img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal">
      <img src="https://www.logo.wine/a/logo/Apple_Pay/Apple_Pay-Logo.wine.svg" alt="Apple Pay">
    </div>

    <button class="btn" onclick="openPM()">Pay</button>

    <!-- Last purchase summary -->
    <div id="lastPurchase" class="last-purchase"></div>
  </div>

  <!-- Payment Modal -->
  <div class="pm-modal" id="pmModal">
    <div class="pm-wrap">
      <div class="pm-header">
        <div class="pm-title">Order Summary</div>
        <button class="pm-close" onclick="closePM()">×</button>
      </div>
      <div class="pm-list">
        <div class="pm-item" data-method="visa">
          <div class="pm-left"><span class="pm-radio"></span><div class="pm-name">Visa</div></div>
          <div class="pm-right"><img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Visa"></div>
        </div>
        <div class="pm-item" data-method="vnpay">
          <div class="pm-left"><span class="pm-radio"></span><div class="pm-name">VNPAY QR</div></div>
          <div class="pm-right"><img src="https://cdn.haitrieu.com/wp-content/uploads/2022/10/Icon-VNPAY-QR.png" alt="VNPAY"></div>
        </div>
        <div class="pm-item" data-method="paypal">
          <div class="pm-left"><span class="pm-radio"></span><div class="pm-name">PayPal</div></div>
          <div class="pm-right"><img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal"></div>
        </div>
        <div class="pm-item" data-method="applepay">
          <div class="pm-left"><span class="pm-radio"></span><div class="pm-name">Apple Pay</div></div>
          <div class="pm-right"><img src="https://www.logo.wine/a/logo/Apple_Pay/Apple_Pay-Logo.wine.svg" alt="Apple Pay"></div>
        </div>
      </div>

      <!-- Visa virtual card (no number) -->
      <div class="pm-card" id="pmCardBox">
        <div class="vcard">Visa Card</div>
      </div>

      <div class="pm-footer">
        <div class="pm-total" id="pmTotal">Total: US$0.00</div>
        <button class="pm-pay" onclick="doPay()">Pay now</button>
      </div>
    </div>
  </div>

  <!-- Loading Modal (spinner first) -->
  <div class="loading-modal" id="loadingModal" style="display:none;">
    <div class="spinner"></div>
  </div>

  <!-- Success modal (centered rounded square) -->
  <div class="final-modal" id="finalModal" style="display:none;">
    <div class="final-card">
      <button class="final-close" onclick="closeFinal()">×</button>
      <div class="check"></div>
      <h3 class="final-title">Purchase completed</h3>
      <div class="final-details" id="finalDetails">You bought <b>0</b> coins for <b>US$0.00</b>.</div>
    </div>
  </div>

  <!-- Quantity keypad sheet -->
  <div class="qty-sheet" id="qtySheet" onclick="if(event.target===this) closeQtySheet()">
    <div class="qty-panel">
      <div class="qty-handle"></div>
      <div class="qty-title">Custom amount</div>
      <div class="qty-range">
        <img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png" alt="">
        <span>0 – 2,500,000</span>
      </div>
      <div class="qty-display" id="qtyDisplay">0</div>
      <div class="qty-keypad" id="qtyPad">
        <div class="qty-key">1</div><div class="qty-key">2</div><div class="qty-key">3</div>
        <div class="qty-key">4</div><div class="qty-key">5</div><div class="qty-key">6</div>
        <div class="qty-key">7</div><div class="qty-key">8</div><div class="qty-key">9</div>
        <div class="qty-key gray" data-act="back">⌫</div><div class="qty-key">000</div><div class="qty-key">0</div>
      </div>
      <div class="qty-row">
        <div class="qty-note">Get 5% bonus on larger packs</div>
        <div class="qty-total" id="qtyTotal">US$0.00</div>
      </div>
      <div class="qty-paybar">
        <div class="qty-paybtn" onclick="applyQty()">Apply</div>
      </div>
    </div>
  </div>

  <script>
    // ===== Helpers =====
    const RATE = 0.99/70; // 70 coins = US$0.99
    const fmtUSD = n => 'US$' + (Number(n)||0).toFixed(2);
    const fmtNum = n => (Number(n)||0).toLocaleString('en-US');

    // ===== Package select (USD) =====
    const packages = document.querySelectorAll('.package');
    const pmTotal = document.getElementById('pmTotal');
    const lastPurchase = document.getElementById('lastPurchase');
    const coinAmountBtn = document.getElementById('coinAmountBtn');
    let selectedAmount = 0;
    let selectedCoins = 0;

    packages.forEach(pkg=>{
      pkg.addEventListener('click',()=>{
        packages.forEach(p=>p.classList.remove('selected'));
        pkg.classList.add('selected');
        selectedCoins = parseInt(pkg.dataset.coins)||0;
        selectedAmount = parseFloat(pkg.dataset.price)||0;
        // sync custom field
        coinAmountBtn.value = selectedCoins ? (fmtNum(selectedCoins) + ' coins') : '';
        // update total
        pmTotal.textContent = 'Total: ' + fmtUSD(selectedAmount);
      });
    });

    // ===== Payment Modal =====
    const pmModal = document.getElementById('pmModal');
    const pmItems = document.querySelectorAll('.pm-item');
    const pmCardBox = document.getElementById('pmCardBox');

    function openPM(){
      pmModal.style.display='block';
      // default select Visa
      pmItems.forEach(i=>i.classList.remove('active'));
      const visa = document.querySelector('.pm-item[data-method="visa"]');
      if(visa){ visa.classList.add('active'); pmCardBox.style.display='block'; }
    }
    function closePM(){
      pmModal.style.display='none';
      pmCardBox.style.display='none';
      pmItems.forEach(i=>i.classList.remove('active'));
    }
    pmItems.forEach(item=>{
      item.addEventListener('click', ()=>{
        pmItems.forEach(i=>i.classList.remove('active'));
        item.classList.add('active');
        pmCardBox.style.display = item.dataset.method==='visa' ? 'block' : 'none';
      });
    });

    // ===== Loading -> Success flow =====
    const loadingModal = document.getElementById('loadingModal');
    const finalModal = document.getElementById('finalModal');
    function doPay(){
      // close payment modal
      pmModal.style.display='none';
      // show loading spinner overlay
      loadingModal.style.display='flex';
      setTimeout(()=>{
        // hide spinner
        loadingModal.style.display='none';
        // update success details
        document.getElementById('finalDetails').innerHTML =
          'You bought <b>' + fmtNum(selectedCoins) + '</b> coins for <b>' + fmtUSD(selectedAmount) + '</b>.';
        // show last purchase under Pay button
        lastPurchase.style.display='block';
        lastPurchase.textContent = 'Last purchase: ' + fmtNum(selectedCoins) + ' coins – ' + fmtUSD(selectedAmount);
        // open success modal
        finalModal.style.display='flex';
      },1500);
    }
    function closeFinal(){
      finalModal.style.display='none';
    }

    // ===== Quantity keypad sheet (MIN=0) =====
    const COIN_MIN = 0, COIN_MAX = 2500000;
    const qtySheet = document.getElementById('qtySheet');
    const qtyDisplay = document.getElementById('qtyDisplay');
    const qtyTotal = document.getElementById('qtyTotal');
    const qtyPad = document.getElementById('qtyPad');

    function openQtySheet(){
      qtySheet.style.display = 'block';
      const cur = selectedCoins || 0;
      qtyDisplay.textContent = fmtNum(cur);
      qtyTotal.textContent = fmtUSD(cur * RATE);
    }
    function closeQtySheet(){ qtySheet.style.display='none'; }

    qtyPad.addEventListener('click', (e)=>{
      const key = e.target.closest('.qty-key');
      if(!key) return;
      let raw = qtyDisplay.textContent.replace(/,/g,'');
      let val = parseInt(raw||'0',10);
      const txt = key.textContent.trim();
      const act = key.dataset.act;

      if(act === 'back'){ val = Math.floor(val/10); }
      else if(txt === '000'){ val = Number(String(val||'0') + '000'); }
      else { val = Number(String(val||'') + txt); }

      if(val>COIN_MAX) val = COIN_MAX;

      qtyDisplay.textContent = fmtNum(val);
      qtyTotal.textContent = fmtUSD(val * RATE);
    });

    function applyQty(){
      const val = parseInt(qtyDisplay.textContent.replace(/,/g,''),10) || 0;
      selectedCoins = val;
      selectedAmount = val * RATE;
      coinAmountBtn.value = val ? (fmtNum(val) + ' coins') : '';
      pmTotal.textContent = 'Total: ' + fmtUSD(selectedAmount);
      // clear package selection (custom mode)
      packages.forEach(p=>p.classList.remove('selected'));
      closeQtySheet();
      // open payment modal immediately
      openPM();
    }
  </script>
</body>
</html>

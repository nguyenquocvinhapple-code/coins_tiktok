<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buy Coins</title>
  <style>
    :root{ --tk-red:#FE2C55; --tk-cyan:#25F4EE; --tk-gray:#F2F3F5; --tk-gray-text:#6B6F76; --text:#0f0f0f; }
    *{box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;background:#f5f5f5;margin:0;padding:20px;text-align:center;color:var(--text)}
    .container{max-width:520px;margin:20px auto;background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 20px rgba(0,0,0,.08);position:relative}
    .logo{width:100px;position:absolute;left:10px;top:10px}
    .divider{margin-top:70px;border-bottom:1px solid #ddd;margin-bottom:12px}
    h1{margin:8px 0 16px;font-size:20px}

    /* Coin packages */
    .package-list{display:grid;grid-template-columns:repeat(auto-fill,minmax(118px,1fr));gap:14px}
    .package{border:1px solid transparent;border-radius:18px;background:var(--tk-gray);box-shadow:none;padding:14px 16px;cursor:pointer;transition:border-color .18s ease,background .18s ease,transform .08s}
    .package:active{transform:scale(.99)}
    .coin{display:flex;align-items:center;justify-content:center;gap:4px;font-size:20px;font-weight:800;color:var(--text)}
    .coin img{width:40px;height:auto}
    .price{margin-top:6px;font-size:14px;color:var(--tk-gray-text)}
    .package.selected{border-color:var(--tk-red);background:#FFF1F4;box-shadow:inset 0 0 0 2px rgba(254,44,85,.06)}
    @media (max-width:390px){.package{padding:12px;border-radius:16px}.coin{font-size:18px}.price{font-size:13px}.coin img{width:36px}}

    .field{margin-top:16px;text-align:left}
    .field label{display:block;margin-bottom:6px;font-weight:600}
    .field input{width:100%;padding:10px;font-size:14px;border:1px solid #ccc;border-radius:8px}
    .field input[readonly]{background:#fafafa;cursor:pointer}

    /* Payment logos: equal size, equal gap, aligned left */
    .payment-logos{display:flex;flex-wrap:nowrap;gap:20px;justify-content:flex-start;align-items:center;margin:14px 0}
    .payment-logos img{width:80px;height:40px;object-fit:contain;object-position:left center;flex:0 0 auto;transition:transform .15s}
    .payment-logos img:active{transform:scale(.95)}

    .btn{margin-top:6px;width:100%;background:var(--tk-red);color:#fff;border:0;border-radius:10px;padding:12px;font-size:16px;font-weight:700;cursor:pointer}

    .last-purchase{display:none;margin-top:10px;font-size:14px;color:#333;background:#f8f8f8;border:1px solid #eee;border-radius:10px;padding:10px;text-align:left}

    /* Payment Modal */
    .pm-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:1100}
    .pm-wrap{background:#fff;border-radius:16px;max-width:520px;margin:60px auto;padding:16px;box-shadow:0 10px 40px rgba(0,0,0,.2);position:relative}
    .pm-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:12px;border-bottom:1px solid #eee}
    .pm-title{font-size:20px;font-weight:700}
    .pm-close{background:transparent;border:0;font-size:22px;cursor:pointer}
    .pm-list{margin:16px 0;display:flex;flex-direction:column;gap:10px}
    .pm-item{display:flex;justify-content:space-between;align-items:center;border:1px solid #ddd;border-radius:12px;padding:12px;cursor:pointer;background:#fff}
    .pm-item.active{border-color:var(--tk-red);box-shadow:0 0 0 2px rgba(254,44,85,.18)}
    .pm-left{display:flex;align-items:center;gap:10px}
    .pm-radio{width:18px;height:18px;border-radius:50%;border:2px solid #bbb;position:relative}
    .pm-item.active .pm-radio{border-color:var(--tk-red)}
    .pm-item.active .pm-radio::after{content:"";position:absolute;inset:3px;border-radius:50%;background:var(--tk-red)}
    .pm-name{font-weight:600}
    .pm-right{display:flex;gap:12px;align-items:center}
    .pm-right img{width:80px;height:24px;object-fit:contain;flex:0 0 auto}

    .pm-card{display:none;margin-top:12px;border:1px dashed #ccc;border-radius:10px;padding:12px;background:#fafafa}
    .pm-card .vcard{background:linear-gradient(135deg,var(--tk-red),var(--tk-cyan));color:#fff;border-radius:12px;padding:14px;display:flex;justify-content:center;font-weight:700}
    .pm-footer{display:flex;justify-content:space-between;align-items:center;margin-top:16px}
    .pm-total{font-weight:700}
    .pm-pay{background:var(--tk-red);color:#fff;border:0;border-radius:999px;padding:12px 20px;font-weight:700;cursor:pointer}

    /* Loading */
    .loading-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:1200;display:flex;align-items:center;justify-content:center}
    .spinner{width:48px;height:48px;border:5px solid #f3f3f3;border-top:5px solid var(--tk-red);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Success */
    .final-modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:1300;display:flex;align-items:center;justify-content:center}
    .final-card{background:#fff;border-radius:20px;padding:20px;width:320px;height:320px;display:flex;flex-direction:column;justify-content:center;align-items:center;position:relative;box-shadow:0 12px 40px rgba(0,0,0,.15);text-align:center}
    .final-close{position:absolute;right:10px;top:8px;background:transparent;border:0;font-size:22px;cursor:pointer}
    .check{width:56px;height:56px;border-radius:16px;background:#2ecc71;position:relative;margin-bottom:8px}
    .check::after{content:"";position:absolute;left:18px;top:13px;width:20px;height:12px;border:4px solid #fff;border-top:none;border-right:none;transform:rotate(-45deg)}
    .final-title{margin:6px 0 4px 0;font-size:18px;font-weight:800}
    .final-details{margin-top:4px;font-size:15px;color:#333}
    .final-details b{font-weight:800}

    /* Keypad overlay (smooth) */
    .qty-sheet{display:none;position:fixed;inset:0;background:rgba(0,0,0,.0);z-index:1200;transition:background .25s ease}
    .qty-sheet.show{background:rgba(0,0,0,.45)}
    .qty-panel{position:absolute;left:0;right:0;bottom:0;background:#fff;border-top-left-radius:16px;border-top-right-radius:16px;padding:14px 16px 18px;box-shadow:0 -8px 30px rgba(0,0,0,.15);transform:translateY(100%);transition:transform .25s ease}
    .qty-sheet.show .qty-panel{transform:translateY(0)}
    .qty-handle{width:44px;height:5px;background:#ddd;border-radius:999px;margin:0 auto 10px}
    .qty-title{font-weight:700;margin:0 0 10px 0;text-align:center}
    .qty-range{display:flex;align-items:center;gap:6px;color:#999;font-size:13px;margin-bottom:8px}
    .qty-range img{width:18px}
    .qty-display{width:100%;border:1px solid #ececec;border-radius:10px;padding:12px;text-align:left;font-weight:700;font-size:16px;color:#333;background:#fff}
    .qty-keypad{margin-top:12px;display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .qty-key{padding:14px 0;background:#f3f3f5;border-radius:10px;font-weight:700;font-size:18px;box-shadow:inset 0 -1px 0 #ececec;user-select:none;text-align:center}
    .qty-key:active{transform:scale(.98);background:#e8e8ec}
    .qty-key.gray{background:#ececec}
    .qty-row{margin-top:10px;display:flex;justify-content:space-between;align-items:center}
    .qty-note{color:#e91e63;font-weight:600;font-size:14px}
    .qty-total{font-weight:700}
    .qty-paybar{display:flex;gap:10px;margin-top:8px}
    .qty-paybtn{flex:1;background:var(--tk-red);color:#fff;border:0;border-radius:999px;padding:12px 10px;font-weight:700;text-align:center}
  </style>
</head>
<body>
  <div class="container">
    <img class="logo" src="https://inuvdp.com/wp-content/uploads/2022/08/tiktok-02.jpg" alt="TikTok"/>
    <div class="divider"></div>
    <h1>Buy Coins</h1>

    <!-- Packages -->
    <div class="package-list" id="pkgList">
      <div class="package" data-coins="350" data-price="4.95"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>350</span></div><div class="price"></div></div>
      <div class="package" data-coins="700" data-price="9.9"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>700</span></div><div class="price"></div></div>
      <div class="package" data-coins="1400" data-price="19.8"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>1400</span></div><div class="price"></div></div>
      <div class="package" data-coins="3500" data-price="49.5"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>3500</span></div><div class="price"></div></div>
      <div class="package" data-coins="7000" data-price="99"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>7000</span></div><div class="price"></div></div>
      <div class="package" data-coins="17500" data-price="247.5"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>17500</span></div><div class="price"></div></div>
      <div class="package" data-coins="50000" data-price="707.142857"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>50000</span></div><div class="price"></div></div>
      <div class="package" data-coins="100000" data-price="1414.285714"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>100000</span></div><div class="price"></div></div>
      <div class="package" data-coins="300000" data-price="4242.857142"><div class="coin"><img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png"><span>300000</span></div><div class="price"></div></div>
    </div>

    <div class="field">
      <label for="tiktokId">TikTok ID</label>
      <input type="text" id="tiktokId" placeholder="@username">
    </div>

    <div class="field">
      <label for="coinAmountBtn">Coin amount (custom)</label>
      <input id="coinAmountBtn" type="text" placeholder="Tap to enter…" readonly onclick="openQtySheet()">
    </div>

    <!-- Logos row -->
    <div class="payment-logos">
      <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Visa">
      <img src="https://cdn.haitrieu.com/wp-content/uploads/2022/10/Icon-VNPAY-QR.png" alt="VNPAY QR">
      <img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal">
      <img src="https://www.logo.wine/a/logo/Apple_Pay/Apple_Pay-Logo.wine.svg" alt="Apple Pay">
    </div>

    <button class="btn" onclick="openPM()">Pay</button>
    <div id="lastPurchase" class="last-purchase"></div>
  </div>

  <!-- Payment Modal -->
  <div class="pm-modal" id="pmModal">
    <div class="pm-wrap">
      <div class="pm-header">
        <div class="pm-title">Order Summary</div>
        <button class="pm-close" onclick="closePM()">×</button>
      </div>
      <div class="pm-list">
        <div class="pm-item" data-method="visa">
          <div class="pm-left"><span class="pm-radio"></span><div class="pm-name">Visa</div></div>
          <div class="pm-right">
            <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Visa">
            <img src="https://cdn.haitrieu.com/wp-content/uploads/2022/10/Icon-VNPAY-QR.png" alt="VNPAY QR">
            <img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" alt="PayPal">
            <img src="https://www.logo.wine/a/logo/Apple_Pay/Apple_Pay-Logo.wine.svg" alt="Apple Pay">
          </div>
        </div>
      </div>

      <div class="pm-card" id="pmCardBox">
        <div class="vcard">Visa Card</div>
      </div>

      <div class="pm-footer">
        <div class="pm-total" id="pmTotal">Total: US$0,00</div>
        <button class="pm-pay" onclick="doPay()">Pay now</button>
      </div>
    </div>
  </div>

  <div class="loading-modal" id="loadingModal" style="display:none;">
    <div class="spinner"></div>
  </div>

  <div class="final-modal" id="finalModal" style="display:none;">
    <div class="final-card">
      <button class="final-close" onclick="closeFinal()">×</button>
      <div class="check"></div>
      <h3 class="final-title">Purchase completed</h3>
      <div class="final-details" id="finalDetails">You bought <b>0</b> coins for <b>US$0,00</b>.</div>
    </div>
  </div>

  <!-- Quantity keypad -->
  <div class="qty-sheet" id="qtySheet" onclick="if(event.target===this) closeQtySheet()">
    <div class="qty-panel">
      <div class="qty-handle"></div>
      <div class="qty-title">Custom amount</div>
      <div class="qty-range">
        <img src="https://cdn.unipin.com/images/icon_product_pages/1749042852-icon-Tiktok.png" alt="">
        <span>0 – 2,500,000</span>
      </div>
      <div class="qty-display" id="qtyDisplay">0</div>
      <div class="qty-keypad" id="qtyPad">
        <div class="qty-key">1</div><div class="qty-key">2</div><div class="qty-key">3</div>
        <div class="qty-key">4</div><div class="qty-key">5</div><div class="qty-key">6</div>
        <div class="qty-key">7</div><div class="qty-key">8</div><div class="qty-key">9</div>
        <div class="qty-key gray" data-act="back">⌫</div><div class="qty-key">000</div><div class="qty-key">0</div>
      </div>
      <div class="qty-row">
        <div class="qty-note">Get 5% bonus on larger packs</div>
        <div class="qty-total" id="qtyTotal">US$0,00</div>
      </div>
      <div class="qty-paybar">
        <div class="qty-paybtn" onclick="applyQty()">Apply</div>
      </div>
    </div>
  </div>

  <script>
    // ===== Helpers (ALL COMMAS) =====
    const RATE = 0.99/70; // 70 coins = 0,99 USD
    function fmtNum(n){
      // Start from en-US (commas as thousands), then replace decimals dot to comma (no decimals for coins)
      return (Number(n)||0).toLocaleString('en-US').replace(/\./g,',');
    }
    function fmtUSD(n){
      // Format with 2 decimals, then replace dot with comma => US$4,242,86
      return 'US$' + (Number(n)||0).toLocaleString('en-US',{minimumFractionDigits:2, maximumFractionDigits:2}).replace(/\./g,',');
    }

    // Initialize package labels using custom comma formatting
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.package').forEach(pkg => {
        const coins = parseInt(pkg.dataset.coins, 10) || 0;
        const price = parseFloat(pkg.dataset.price) || 0;
        pkg.querySelector('.coin span').textContent = fmtNum(coins);
        pkg.querySelector('.price').textContent = fmtUSD(price);
      });
    });

    // ===== Package select =====
    const packages = document.querySelectorAll('.package');
    const pmTotal = document.getElementById('pmTotal');
    const lastPurchase = document.getElementById('lastPurchase');
    const coinAmountBtn = document.getElementById('coinAmountBtn');
    let selectedAmount = 0;
    let selectedCoins = 0;

    packages.forEach(pkg=>{
      pkg.addEventListener('click',()=>{
        packages.forEach(p=>p.classList.remove('selected'));
        pkg.classList.add('selected');
        selectedCoins = parseInt(pkg.dataset.coins)||0;
        selectedAmount = parseFloat(pkg.dataset.price)||0;
        coinAmountBtn.value = selectedCoins ? (fmtNum(selectedCoins) + ' coins') : '';
        pmTotal.textContent = 'Total: ' + fmtUSD(selectedAmount);
      });
    });

    // ===== Payment Modal =====
    const pmModal = document.getElementById('pmModal');
    const pmItems = document.querySelectorAll('.pm-item');
    const pmCardBox = document.getElementById('pmCardBox');

    function openPM(){
      pmModal.style.display='block';
      pmItems.forEach(i=>i.classList.remove('active'));
      const visa = document.querySelector('.pm-item[data-method="visa"]');
      if(visa){ visa.classList.add('active'); pmCardBox.style.display='block'; }
    }
    function closePM(){
      pmModal.style.display='none';
      pmCardBox.style.display='none';
      pmItems.forEach(i=>i.classList.remove('active'));
    }
    pmItems.forEach(item=>{
      item.addEventListener('click', ()=>{
        pmItems.forEach(i=>i.classList.remove('active'));
        item.classList.add('active');
        pmCardBox.style.display = item.dataset.method==='visa' ? 'block' : 'none';
      });
    });

    // ===== Loading -> Success =====
    const loadingModal = document.getElementById('loadingModal');
    const finalModal = document.getElementById('finalModal');
    function doPay(){
      pmModal.style.display='none';
      loadingModal.style.display='flex';
      setTimeout(()=>{
        loadingModal.style.display='none';
        document.getElementById('finalDetails').innerHTML =
          'You bought <b>' + fmtNum(selectedCoins) + '</b> coins for <b>' + fmtUSD(selectedAmount) + '</b>.';
        lastPurchase.style.display='block';
        lastPurchase.textContent = 'Last purchase: ' + fmtNum(selectedCoins) + ' coins – ' + fmtUSD(selectedAmount);
        finalModal.style.display='flex';
      },1500);
    }
    function closeFinal(){ finalModal.style.display='none'; }

    // ===== Keypad overlay =====
    const COIN_MAX = 2500000;
    const qtySheet = document.getElementById('qtySheet');
    const qtyDisplay = document.getElementById('qtyDisplay');
    const qtyTotal = document.getElementById('qtyTotal');
    const qtyPad = document.getElementById('qtyPad');

    function openQtySheet(){
      qtySheet.style.display = 'block';
      requestAnimationFrame(()=> qtySheet.classList.add('show'));
      const cur = selectedCoins || 0;
      qtyDisplay.textContent = fmtNum(cur);
      qtyTotal.textContent = fmtUSD(cur * RATE);
    }
    function closeQtySheet(){
      qtySheet.classList.remove('show');
      setTimeout(()=>{ qtySheet.style.display='none'; }, 250);
    }

    qtyPad.addEventListener('click', (e)=>{
      const key = e.target.closest('.qty-key');
      if(!key) return;
      // Parse by stripping commas (thousands) and interpreting last comma as decimal if any (we don't use decimals for coins)
      let raw = qtyDisplay.textContent.replace(/,/g,'');
      let val = parseInt(raw||'0',10);
      const txt = key.textContent.trim();
      const act = key.dataset.act;

      if(act === 'back'){ val = Math.floor(val/10); }
      else if(txt === '000'){ val = Number(String(val||'0') + '000'); }
      else { val = Number(String(val||'') + txt); }

      if(val>COIN_MAX) val = COIN_MAX;

      qtyDisplay.textContent = fmtNum(val);
      qtyTotal.textContent = fmtUSD(val * RATE);
    });

    function applyQty(){
      const raw = qtyDisplay.textContent.replace(/,/g,'');
      const val = parseInt(raw,10) || 0;
      selectedCoins = val;
      selectedAmount = val * RATE;
      coinAmountBtn.value = val ? (fmtNum(val) + ' coins') : '';
      pmTotal.textContent = 'Total: ' + fmtUSD(selectedAmount);
      packages.forEach(p=>p.classList.remove('selected')); // custom mode
      closeQtySheet();
      openPM();
    }
  </script>
</body>
</html>
